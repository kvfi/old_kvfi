---
layout: post
title: The Grand taxi experiment
slug: GrandTaxiExperiment
subtitle: Using computational sociology and traffic engineering to map low-income neighborhoods in Casablanca
published: 2016-12-01
updated: 2016-12-02
progress: ongoing
epistemic_state: almost believed
difficulty: 2
category: engineering
tags:
 - mathematical modeling
 - traffic engineering
online: true
---
__Before starting__ I want to hint at the pains I went through during this experiment and how data has been a real affliction to gather. I did a lot of back office work, like building models, running simulations, doing some [computational sociology](https://en.wikipedia.org/wiki/Computational_sociology) (which is not extensively developed here, perhaps I'll add the deatails later on), and to be fully honest, this essay is a pretty good example of an [“is–ought problem”](https://en.wikipedia.org/wiki/Is%E2%80%93ought_problem). This is why, and considered my leaning for strong evaluation, I labbeled this article epistemic level under “almost-believed” (the first of its kind), as it might be ameliorated to some degree. I hope to come back at this article at a later time and, if possibly, review some of the points I believe do need some additional investigation.

----

> “It was possible, no doubt, to imagine a society in which wealth, in the sense of personal possessions and luxuries, should be evenly distributed, while power remained in the hands of a small privileged caste. But in practice such a society could not long remain stable. For if leisure and security were enjoyed by all alike, the great mass of human beings who are normally stupefied by poverty would become literate and would learn to think for themselves; and when once they had done this, they would sooner or later realise that the privileged minority had no function, and they would sweep it away. In the long run, a hierarchical society was only possible on a basis of poverty and ignorance.” &mdash; George Orwell[^orwell poverty]

When I published _[“Correlating youth unemployment in Morocco”](/post/morocco-youth-unemployment)_ back in 2011, my readers started to have suspicious observations whether my interest in Morocco's employment policies unintentionally revealed some sort of parentage. And this essay won't help. Though I believe that [Casablanca](https://en.wikipedia.org/wiki/Casablanca) offers a remarkable framework to explore the many social regards of emerging economies.
My interest in correlating paths and low-income neighborhood started when I read [_“Income inequality is cyclical”_](http://www.nature.com/news/income-inequality-is-cyclical-1.20618) by economist and inequality specialist [Branko Milanović](https://en.wikipedia.org/wiki/Branko_Milanovi%C4%87) (who's by the way the author of a quiet decent book I would recommend [“Worlds Apart: Measuring International and Global Inequality”](http://press.princeton.edu/titles/7946.html)[^worlds_apart]). My first thought was how, with all this dodgy data, one can do social inequality metrics on such large/global scales. In Morocco, like many other countries with low or no [advocacy evaluation](https://en.wikipedia.org/wiki/Advocacy_evaluation), both data [consitency](https://en.wikipedia.org/wiki/Data_consistency) and [integrity](https://en.wikipedia.org/wiki/Data_integrity) are usually poor and substandard. The lack of robustness in public data is such that it is almost impossible to draw any inference with confidence. I then came with the idea that recording [_Grand Taxis_](https://en.wikipedia.org/wiki/Taxicabs_of_Morocco#Grands_Taxis) paths was a good way to map regional income inequality knowing that the was majority of individuals riding those cabs were people from the [underclass](https://en.wikipedia.org/wiki/Underclass). I would subsequently be able to map low-income neighborhoods by interweaving routes and destinations. After running the experiment for [20 days, 8 hours and 22 minutes](#duration), it became self-evident that the probe was leading to convincing results. This is the storyline of the _Grand Taxi Experiment_.

#### Before gathering the data {#before_gathering_data}
The fastest, cheapest and easiest way to build a device that tracks motion at distance in real-time is using an [Arduino Due](https://www.amazon.com/Arduino-org-A000062-Arduino-Due/dp/B00A6C3JN2) micro-controller, based on the [Atmel SAM3X8E ARM CPU](http://www.atmel.com/Images/Atmel-11057-32-bit-Cortex-M3-Microcontroller-SAM3X-SAM3A_Datasheet.pdf), a [MediaTek MT3339](https://www.pololu.com/product/2138) GPS chip and 3G [HSPA](https://en.wikipedia.org/wiki/High_Speed_Packet_Access) wireless mobile Internet access. `.gpx`[^gpx files] files were uploaded to a [Raspberry Pi 3 Model B](https://www.raspberrypi.org/products/raspberry-pi-3-model-b/) [network storage device](https://en.wikipedia.org/wiki/Network-attached_storage). Micro-controller programming to handle real-time data upload was in [C](https://en.wikipedia.org/wiki/C_(programming_language)) and [Assembly](https://en.wikipedia.org/wiki/Assembly_language). Finally, thin [nickel](https://en.wikipedia.org/wiki/Nickel) pads to lock the device to taxis.

Once all the technicalities setup, the leading difficulty was to actually anchor the tracker to the cars' back bumbers. Facing the reticence and [social inhibition](https://en.wikipedia.org/wiki/Social_inhibition#Adulthood) of Moroccan taxi drivers to take part in the experiment (only 2 accepted to be tracked), I decided to take regular routes on highly-frequeted tracks. Taking bagages allowed me to access the trunk and, while opened it was much easier to fasten the tracker. I usually asked to step out at low-traffic locations, keeping outsiders looks away. I managed to track 19 vehicules (21 attached, 2 lost) for at total of 20 days.

#### Crossing paths {#crossing_paths}
In an effort to map low-income neighborhoods in Casablanca, an important part of this experiment was to understand how Grand taxis behave. Even if collected GPS metrics successfuly passed the [Tukey's test](https://en.wikipedia.org/wiki/Tukey%27s_test_of_additivity)[^tests_of_additivity], [microscale models](https://en.wikipedia.org/wiki/Microscale_and_macroscale_models) provide better insights. [Discrete probability distributions](https://en.wikipedia.org/wiki/Probability_distribution#Discrete_probability_distribution), particularly the [Chi-squared](https://en.wikipedia.org/wiki/Chi-squared_distribution) distribution, were the most fit to provide good utility, considered the problem statement.
A reliable approach was to consider [PDEs](https://en.wikipedia.org/wiki/Partial_differential_equation) in order to conceive a model for the [density](https://en.wikipedia.org/wiki/Density) $\rho(x,t)$ of taxis per unit lenght, as a function of position $x$ and time $t$, given primary density $\rho(x, 0)$.
* Known variables were `position` $x$, `time` $t$, `density` $\rho = \rho(x,t)$, `velocity` $v = (x,t)$, `flux` $J = J(x,t)$.
* The lenght of the cars (though taxis practically have the same), the spacing between them, the lenght of the road, the number of lanes, the weather, potential accidents/traffic jam (knowing for a fact that traffic in Casablanca is propigious to accidents[^casablanca accidents]) and [traffic congestion](https://en.wikipedia.org/wiki/Traffic_congestion) are important parameters to take into account to avoid [false dilemnas](https://en.wikipedia.org/wiki/False_dilemma) (see [Morton's fork](https://en.wikipedia.org/wiki/Morton%27s_fork)) and [approximation errors](https://en.wikipedia.org/wiki/Approximation_error).
* For to feasibility reasons, I will ignore [multivariate random variables](https://en.wikipedia.org/wiki/Multivariate_random_variable) such as hard-to-predict eventualities and [contingency](https://en.wikipedia.org/wiki/Contingency_(philosophy)).
> “The disproportionate role of high-profile, hard-to-predict, and rare events that are beyond the realm of normal expectations in history, science, finance, and technology. The non-computability of the probability of the consequential rare events using scientific methods (owing to the very nature of small probabilities)”.
  &mdash; See [Black swan theory](https://en.wikipedia.org/wiki/Black_swan_theory).

Let's now build a usable PDE model, which reads:
$$\begin{cases} \frac{\partial\rho}{\partial t} + \frac{\partial}{\partial x}(\rho v) & = 0 \\\\ \rho(x,0) & = f(x)\end{cases}$$ Bear in mind this model is an approximation since we assumed density to be continious.

I already know that the people using Grand Taxis are from the underclass, thus making it easier to work on a predefined [population sample](https://en.wikipedia.org/wiki/Sample_(statistics)). Though, differentiating forced stops (lights, police control) from [traffic congestion](https://en.wikipedia.org/wiki/Traffic_congestion) is way trickier. To answer ths particular question, let's focus on density and how it evolves. I use a [time-space diagram](http://www.webpages.uidaho.edu/niatt_labmanual/chapters/trafficflowtheory/theoryandconcepts/TimeSpaceDiagram.htm) to meseare density over time.

We may notice that the more taxis are situated in the same area, the most likely there is to be a bigger traffic flow.

[^opposing social order]: [Eugene V. Debs](https://en.wikipedia.org/wiki/Eugene_V._Debs), _“Labor and Freedom”_  was an American union leader, one of the founding members of the Industrial Workers of the World (IWW or the Wobblies), and five times the candidate of the Socialist Party of America for President of the United States.[3] Through his presidential candidacies, as well as his work with labor movements, Debs eventually became one of the best-known socialists living in the United States. Early in his political career, Debs was a member of the Democratic Party. He was elected as a Democrat to the Indiana General Assembly in 1884. After working with several smaller unions, including the Brotherhood of Locomotive Firemen, Debs was instrumental in the founding of the American Railway Union (ARU), one of the nation's first industrial unions. After workers at the Pullman Palace Car Company organized a wildcat strike over pay cuts in the summer of 1894, Debs signed many into the ARU. He called a boycott of the ARU against handling trains with Pullman cars, in what became the nationwide Pullman Strike, affecting most lines west of Detroit, and more than 250,000 workers in 27 states. To keep the mail running, President Grover Cleveland used the United States Army to break the strike. As a leader of the ARU, Debs was convicted of federal charges for defying a court injunction against the strike and served six months in prison.
[^orwell poverty]: [George Orwell, 1984](https://en.wikipedia.org/wiki/Nineteen_Eighty-Four).
[^worlds_apart]: Worlds Apart:
[“Measuring International and Global Inequality”](http://press.princeton.edu/titles/7946.html), One of Choice's Outstanding Academic Titles for 2005, eBook, ISBN: 9781400840816.
[^gpx files]: [GPX (the GPS Exchange Format)](http://www.topografix.com/gpx.asp) is a light-weight XML data format for the interchange of GPS data (waypoints, routes, and tracks) between applications and Web services on the Internet.
[^tests_of_additivity]: Considering the burdensomeness of the experiment and how data was collected (microscale), I proceeded to every viable tests to ensure data consistency.
[^casablanca accidents]: No official data available, but [local news frequently reports car wrecks](https://www.google.com/search?q=accident+casablanca).